\appendixsection{Purkka-kielen yksityiskohtia}
\appendixlabel{app:purkka}

\counterwithout{listing}{section}

\renewcommand{\subsection}[1]{\vspace{1.7ex}{\large\textbf{#1}\vspace{1.3ex}}}

%\makeatletter
%\show\@startsection
%\makeatother
%{subsection}{2}{\z@ }{-3.25ex\@plus -1ex \@minus -.2ex}{1.5ex \@plus .2ex}{\normalfont \large \bfseries }.

\subsection{Alkeistyypit}

Taulukko ei sisällä keskenään identtisiä C-tyyppejä, kuten \texttt{int} ja
\texttt{signed int}. \\[0.3cm]
\begin{tabular}{@{}p{5.8cm}p{8.7cm}@{}} \toprule
    Purkka-tyyppi & Purkka-tyyppiä vastaava C-tyyppi \\ \midrule
    \texttt{void} & \texttt{void} \\
    \texttt{char} & \texttt{char} \\
    \texttt{i8}, \texttt{i16}, \texttt{i32}, \texttt{i64} &
    \texttt{int8\_t}, \texttt{int16\_t}, \texttt{int32\_t}, \texttt{int64\_t} \\
    \texttt{u8}, \texttt{u16}, \texttt{u32}, \texttt{u64} &
    \texttt{uint8\_t}, \texttt{uint16\_t}, \texttt{uint32\_t}, \texttt{uint64\_t} \\
    \texttt{float} & \texttt{float} \\
    \texttt{double} & \texttt{double} \\
    [0.3cm]

    \texttt{cbyte}, \texttt{cshort}, \texttt{cint}, \texttt{clong}, \texttt{clonglong}
    & \texttt{signed char}, \texttt{short}, \texttt{int}, \texttt{long}, \texttt{long long} \\
    \noalign{\vspace{0.3cm}}

    \texttt{cubyte}, \texttt{cushort}, \texttt{cuint}, \texttt{culong}, \texttt{culonglong}
    & \texttt{unsigned char}, \texttt{unsigned short}, \texttt{unsigned int},
      \texttt{unsigned long}, \texttt{unsigned long long} \\
    \bottomrule
\end{tabular} \\

\subsection{Osoitintyypit, taulukkotyypit sekä yhdistetyypit}

\begin{tabular}{@{}ll@{}} \toprule
    Purkka-tyyppi & Purkka-tyyppiä vastaava C-tyyppi tai sen hahmotelma \\ \midrule
    \texttt{\&T, \&?T} & \texttt{T *} \\
    [0.2cm]

    \texttt{[T]} & \texttt{T\textsubscript{declaration specifiers}[]T\textsubscript{direct abstract declarator}} \\
    \texttt{[T;expr]} & \texttt{T\textsubscript{declaration specifiers}[expr]T\textsubscript{direct abstract declarator}} \\
    [0.2cm]

    \texttt{fun t: (T ..) -> R} & \texttt{R\textsubscript{declaration specifiers}~t(T ..)R\textsubscript{direct abstract declarator}} \\
    \texttt{fun (T ..) -> R} & \texttt{R\textsubscript{declaration specifiers}~(*)(T ..)R\textsubscript{direct abstract declarator}} \\
    [0.2cm]

    \texttt{struct \{ k: T ..\}} & \texttt{struct \{ T k ..\}} \\
    \texttt{enum \{ A [= expr] ..\}} & \texttt{enum \{ A [= expr] ..\}} \\
    \texttt{union \{ k: T ..\}} & \texttt{union \{ T k ..\}} \\
    [0.2cm]

    \texttt{(T1 ..)} & \texttt{struct \{ T1 e1; ..\}} \\
    \texttt{enum \{ T(T1 ..) .. \}} & \texttt{struct \{ union \{T1 t1 ..\} v; enum \{T ..\} e;\}} \\
    [0.2cm]

    GCC-laajennokset & \\
    \texttt{attribute(T, ...))} & \texttt{T \_\_attribute\_\_((...))} \\

    \bottomrule
\end{tabular} \\

\begin{listing}[ht!]
    \inputminted{Rust}{koodi/sumtype.prk}
    \inputminted{Rust}{koodi/sumtype.c}
    \caption{Summatyyppi Purkka-kielessä (yllä) ja sama summatyyppi
    suoraviivaisesti käännettynä C-kielelle (alla).}
    \label{fig:purkkatreecompile}
\end{listing}

\begin{listing}[ht!]
    \inputminted{Rust}{koodi/sumtype2.c}
    \caption{Ohjelman~\ref{fig:purkkatreecompile} optimoitu C-versio.}
    \label{fig:purkkatreecompile2}
\end{listing}
