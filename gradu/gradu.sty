\ProvidesPackage{gradu}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{microtype}
\usepackage{amsfonts,amsmath,amssymb,amsthm,booktabs,color,enumitem,graphicx}
\usepackage[pdftex,hidelinks]{hyperref}
\usepackage{bookmark}
\usepackage{appendix}
\usepackage[natbibapa,sectionbib]{apacite}
\usepackage[finnish]{babel}
\usepackage{hyperref}
\usepackage{multirow}
\usepackage{tikz}
\usepackage{placeins}
\usepackage{import}
\usepackage{etoolbox}
\usepackage{refcount}
\usepackage{tocloft}
\usepackage[nottoc]{tocbibind}
\usepackage{xassoccnt}
%\usepackage{showframe}

%\usepackage[top=2em]{geometry}
%\usepackage{showframe}

%\usepackage[style=apa]{biblatex}
%\DeclareLanguageMapping{finnish}{finnish-apa}

\bibliographystyle{apacite}

%\addto\captionsfinnish{\renewcommand{\refname}{LÃ¤hteet}}

\addto{\captionsfinnish}{%
        \renewcommand{\refname}{Bibliography}%
            \renewcommand{\contentsname}{Table of Contents}}

\newcommand{\citationneeded}{\textbf{[citation\_needed]}}

\makeatletter
\newcommand{\totalpagecount}{\pageref{mylastpage}}
\newcommand{\totalappendixcount}{%
    \@ifundefined{r@appendixbegin}{0}{%
        \the\numexpr\TotalValue{totalrealpage}-\getpagerefnumber{mylastpage}-2\relax%
    }%
}
\numberofpagesinformation{%
    \@ifundefined{r@appendixbegin}{%
    \totalpagecount\ sivua%
    }{%
    \totalpagecount\ sivua + \totalappendixcount\ liitesivua%
    }%
}

\makeatother


\newcounter{appendixCount}
\newcounter{appendixPageCount}

\NewTotalDocumentCounter{totalrealpage}
\NewDocumentCounter{realpage}

\DeclareAssociatedCounters{page}{realpage,totalrealpage}
\makeatletter
\AtBeginDocument{%
      \setcounter{realpage}{1}
      }

      \makeatother

\newcommand{\appendixsection}[1]{
    \newpage
    \pagenumbering{arabic}
    \phantomsection
    \stepcounter{appendixCount}
    \section*{Liite \arabic{appendixCount}. #1}
    \cftaddtitleline{toc}{section}{\arabic{appendixCount} #1}{}
}


\DeclareAssociatedCounters{page}{appendixPageCount}
\makeatletter
\AtBeginDocument{%
\stepcounter{appendixPageCount}
}

\newcommand{\appendixbeginhere}{
    \label{mylastpage}
    \newpage
    \label{appendixbegin}
    \cftaddtitleline{toc}{section}{Liitteet}{}
    \pagenumbering{gobble}
    \appendix
    \renewcommand{\thesection}{{\arabic{section}}}
}

\newcommand{\tocbeginshere}{\label{tocbegin}}
\newcommand{\appendixendhere}{\label{appendixend}}

\newcommand{\hilight}[1]{\colorbox{yellow}{#1}}
